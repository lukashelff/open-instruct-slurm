name: open-instruct-smoke-test
description: "No-GPU smoke test: verify container, uv, filesystem, and imports"
workspace: P_HessianEuropeLLM
project: sRL

bind_mounts:
  - container_path: /pfss/mlde/workspaces/
    host_path: /pfss/mlde/workspaces/
    propagation: rprivate
    read_only: false
  - container_path: /pfss/mlde/users/
    host_path: /pfss/mlde/users/
  - container_path: /etc/hosts
    host_path: /etc/hosts
    propagation: rprivate
    read_only: true

debug: false

environment:
  add_capabilities:
    - IPC_LOCK
  environment_variables:
    - TMPDIR=/tmp
    - HOME=/pfss/mlde/workspaces/mlde_wsp_P_HessianEuropeLLM/soofi_ai
    - UV_CACHE_DIR=/pfss/mlde/workspaces/mlde_wsp_P_HessianEuropeLLM/soofi_ai/.cache/uv
    - HF_HOME=/pfss/mlde/workspaces/mlde_wsp_P_HessianEuropeLLM/soofi_ai/.cache/huggingface
    - NLTK_DATA=/pfss/mlde/workspaces/mlde_wsp_P_HessianEuropeLLM/soofi_ai/.cache/nltk_data
    - TOKENIZERS_PARALLELISM=FALSE
    - HF_HUB_ENABLE_HF_TRANSFER=1
  force_pull_image: true
  image:
    cuda: helffml/open_instruct_dev:det
    cpu: helffml/open_instruct_dev:det

resources:
  resource_pool: 42_Compute
  slots_per_trial: 0
  shm_size: 1500000000

searcher:
  name: single
  max_length:
    epochs: 1
  metric: status

max_restarts: 0

entrypoint: bash scripts/train/slr_determined/smoke_test.sh
